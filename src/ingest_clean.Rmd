---
title: "ingest_clean"
author: "bradley"
date: "3/23/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
```

```{r}
colsandwidths <- tribble(
  ~width, ~colname,
  6, "F",
  1, "Version",
  2, "FILLER",
  1, "Obstetric Estimate Tabulation Flag",
  4, "Delivery Year",
  2, "Delivery Month",
  4, "F",
  4, "Delivery Time",
  1, "Weekday",
  2, "Territory of Occurence",
  2, "F",
  3, "County FIPS",
  1, "County Population",
  1, "Delivery Place (revised)",
  1, "Delivery Place",
  16, "F",
  1, "Delivery Place Recode",
  31, "F",
  1, "Mother Age Imputed",
  1, "Reported age of Mother Flag",
  2, "Mother single year of age",
  2, "Mother age recode 14",
  1, "Mother age recode 9",
  2, "Mother Birth Country",
  4, "F",
  1, "Mother Birth State REcode",
  4, "Mother FIPS County",
  2, "F",
  3, "Population of Residence County",
  5, "F",
  1, "Record Type",
  17, "Residence Status",
  1, "Mother Race Recode 31",
  1, "Mother Race Recode 6",
  2, "Mother Race Recode 15",
  1, "Mother BRidged Race Recode",
  2, "Mother Race Imputed",
  1, "F",
  1, "Mother Hispanic Origin",
  3, "Mother Bridged Race/Hispanic Origin",
  1, "Mother Race/Hispanic Origin",
  1, "Mother Education Revised",
  1, "F",
  1, "Father Reported Age Used",
  26, "F",
  1, "Father Combined Age",
  4, "Father Age Recode 11",
  2, "Prior BIrths Now Living",
  2, "Prior Births Now Dead",
  2, "F",
  2, "Live Birth Order Recode",
  2, "F",
  1, "Interval Since Last Live Birhtday Recode",
  9, "Interval Since Last Live Birth Recode 11",
  3, "Month Prenatal Care Began (Revised)",
  2, "Month PRenatal Care Began (Revised) A",
  2, "F",
  1, "WIC",
  24, "Cigarettes Before Pregnancy",
  1, "Cigarettes 1st Trimester",
  2, "Cigarettes 2nd Trimester",
  2, "Cigarettes 3rd Trimester",
  2, "Cigarette Recode (revised)",
  2, "F",
  1, "Mother Height (Inch)",
  4, "BMI",
  2, "BMI Recode",
  4, "F",
  1, "Prepregnancy Weight Recode",
  3, "F",
  3, "Prepregnancy Diabetes",
  1, "Gestational Diabetes",
  1, "Prepregnancy Hpertension",
  1, "Gestational Hypertension",
  1, "Hypertension Eclampsia",
  1, "Infertility Treatment",
  1, "Fertility Enhancing Drugs",
  1, "Asst Reproductive Technology",
  1, "Previous Cesareans",
  1, "Previous Cesareans Num",
  1, "F",
  2, "DIabetes",
  1, "Chronic Hypertension",
  1, "Pregnancy ASsociated Hypertension",
  1, "Eclampsia",
  1, "Breech Delivery",
  1, "Fetal PResentation",
  1, "Route and Method of Delivery",
  1, "Trial of Labour Attempted",
  1, "Delviery Method Recode (revised)",
  1, "Forceps",
  1, "Vacuum",
  1, "Delivery Method Recode",
  1, "Ruptured Uterus",
  1, "Admit to Intensive Care",
  1, "Attendant",
  1, "F",
  1, "Plurality Recode",
  1, "F",
  17, "Plurality Imputed",
  1, "F",
  1, "Set Order Recode",
  1, "F",
  2, "Sex of Infant",
  1, "Sex Imputed",
  9, "Last Normal Menses Month",
  1, "F",
  1, "Last Normal Menses Year",
  2, "F",
  2, "Gestation Imputed Flag",
  4, "Obstetric Estimate of Gestation Using Flag",
  3, "Gestation Detail in Weeks",
  1, "Gestation Recode 12",
  1, "Gestation Recode 5",
  2, "Obstetric Gestation",
  2, "F",
  1, "Combined Gestation Used Flag",
  2, "F",
  1, "COmbined Gestation Used Flag",
  1, "Obstetric Estimate Edited",
  2, "Obstetric Estimate Recode 12",
  2, "Obstetric Estimate Recode 5",
  1, "F",
  4, "Birth Weight Grams",
  4, "Birth Weight Recode",
  2, "Birth Weight Recode 4",
  1, "F",
  1, "Estimated Time of Fetal Death",
  1, "Autopsy Performed",
  1, "Histological Placental Exam Performed",
  1, "Autopsy/Hist Results used in Cause",
  11, "F",
  66, "Flags",
  2610, "F"
)
```


```{r}
y <- read.fwf("data/cdc/Fetal2015US.txt", 
              widths = colsandwidths$width,
              col.names = colsandwidths$colname,
              header = FALSE,
              n = 100,
              stringsAsFactors = FALSE
)

end_flags <-
  c("Education of Mother",
    "Obstetric Estimate of Gestation",
    "Tobaccu Use",
    "Mother Height",
    "Pregnancy Weight",
    "WIC",
    "Prepregnancy diabetes",
    "Gestational diabetes",
    "prepregnancy hypertension",
    "gestational hypertension",
    "hypertension eclampsia",
    "infertility treatment",
    "fertility enhance drug",
    "reproductive tech",
    "prev cesarean",
    "num of prev cesarean",
    "fetal presentation",
    "final route and method of delivery",
    "trial of labour attempted",
    "ruptured uterus",
    "admission to ICU",
    "month prenatal care began",
    "combined gestation",
    "cig before preg",
    "cig before 1",
    "cig before 2",
    "cig before 3",
    "facility",
    "delivery method recode",
    "diabetes flag",
    "chron hyper flag",
    "preg assoc hyper flag",
    "eclampsia flag",
    "breech flag",
    "forceps flag",
    "vacuum flag",
    "mother hispanic origin flag",
    "mother race revised flag",
    "father age flag",
    "live birth month flag",
    "F",
    "last normal menses month flag",
    "F",
    "last normal menses year flag",
    "mother age flag",
    "attendant flag",
    "F",
    "estimated time of fetal death (revised)",
    "autopsy flag",
    "histological placement flag",
    "mothers bridged race recode flag",
    "num of prev births flag")
```